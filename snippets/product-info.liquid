{{ 'product-customize.css' | asset_url | stylesheet_tag }}

<div class="Product__InfoWrapper">
  <div class="Product__Info">
    <div class="Container">
      <div id="product-title">{{ product.title }}</div>
      {%- assign has_ouputted_variant_selector = false -%}

      {%- form 'product'
        , product
        , class: 'ProductForm' -%}
        {%- render 'product-data'
          , product: product -%}

        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when '@app' -%}
              {%- render block -%}

            {%- when 'product_meta' -%}
              <div class="mobile-hide">
                {{ title_and_price }}
              </div>
              <div
                hook-widget-count="{{ product.id }}"
                class="sold-count-widget"
                data-counter="{{ product.metafields['app--71373979649--soldcount'].counter }}"
                data-resent="{{ product.metafields['app--71373979649--soldcount'].customer }}"></div>


            {%- when 'share_buttons' -%}
              <div class="ProductMeta__ShareButtons hidden-pocket" {{ block.shopify_attributes }}>
                <span class="ProductMeta__ShareTitle Heading Text--subdued u-h7">{{ 'product.form.share' | t }}</span>

                {%- assign share_url = shop.url | append: product.url -%}
                {%- assign twitter_text = product.title -%}
                {%- assign pinterest_description = product.description | strip_html | truncatewords: 15 | url_param_escape -%}
                {%- assign pinterest_image = product.featured_image | img_url: 'large' | prepend: 'https:' -%}

                <div class="ProductMeta__ShareList Text--subdued">
                  <a
                    class="ProductMeta__ShareItem"
                    href="https://www.facebook.com/sharer.php?u={{ share_url }}"
                    target="_blank"
                    rel="noopener"
                    aria-label="Facebook">{%- render 'icon' with 'facebook' -%}</a>
                  <a
                    class="ProductMeta__ShareItem"
                    href="https://twitter.com/share?{% if twitter_text != blank %}text={{twitter_text}}&{% endif %}url={{ share_url }}"
                    target="_blank"
                    rel="noopener"
                    aria-label="Twitter">{%- render 'icon' with 'twitter' -%}</a>
                  <a
                    class="ProductMeta__ShareItem"
                    href="https://pinterest.com/pin/create/button/?url={{ share_url }}{% if pinterest_image != blank %}&media={{ pinterest_image }}{% endif %}&description={{ pinterest_description }}"
                    target="_blank"
                    rel="noopener"
                    aria-label="Pinterest">{%- render 'icon' with 'pinterest' -%}</a>
                </div>
              </div>

            {%- when 'variant_selector' -%}
              <div class="variants-container">
                {% if product.has_only_default_variant != true %}
                  {% assign color_option = product.options_by_name.Color %}
                  {% assign size_option = product.options_by_name.Size %}
                  {% assign neck_size_and_color_width = product.options_by_name['Neck Size and Collar Width'] %}
                    {% if product.options.size >= 2 %}
                    <div class="color-size-variant-container">
                      {% for color_value in color_option.values %}
                        {%- for variant in product.variants -%}
                          {%- if variant.option1 == color_value and variant.image -%}
                            {% assign swatch_image = variant.image %}
                            {% assign swatch_variant = variant %}
                            {% break %}
                          {%- endif -%}
                        {%- endfor -%}

                        {% if swatch_image %}
                          <div class="variant-image-container-color" data-product-option>
                            {{ swatch_image
 | image_url: width: 200, height: 200, crop: 'center'
 | image_tag:
 loading: 'eager',
 alt: swatch_variant.option1,
 class: 'variant-image',
 data_url: swatch_variant.url,
 data_option_name: product.options[0],
 data_option_value: color_value,
 data_option_position: color_option.position,
 data_id: swatch_variant.id }}
                            <div class="title">
                              {{ color_value }}
                            </div>
                          </div>
                        {% endif %}
                      {% endfor %}
                    </div>

                    {% comment %} SIZE after select {% endcomment %}
                    <div id="after-select-size"></div>

                    <div class="variant-size" data-product-option>
                      {% for size in size_option.values %}
                        <div
                          class="title-size"
                          data-size="{{ size }}"
                          data-product-option
                          data-option-position="{{ size_option.position }}"
                          data-option-name="{{ product.options[1] }}"
                          data-option-value="{{ size | escape }}"
                          data-id="{{ size }}">
                          {{ size }}
                        </div>
                      {% endfor %}
                    </div>

                  {% else %}
                    {% if variant.image %}
                      <div class="color-size-variant-container">
                        {% for variant in product.variants %}
                          <div class="variant-image-container-color" data-product-option>
                            {{ variant.image 
 | image_url: width: 200, height: 200, crop: 'center' 
 | image_tag: loading: 'eager', alt: variant.title, class: 'variant-image', data-url: variant.url,
 data_option_value: variant.title, 
 data_option_name: product.options[0],
 data_option_position: variant.options_positions[0], 
 data_id: variant.id
                            }}
                            <div class="title">
                              {{ variant.title }}
                            </div>
                          </div>
                        {% endfor %}
                      </div>

                    {% else %}
                      <div id="after-select-size"></div>
                      <div class="variant-size" data-product-option>
                        {% comment %} SIZE after select {% endcomment %}
                        {% for variant in product.variants %}
                          <div
                            class="title-size"
                            data-option-name="{{ product.options[0] }}"
                            data-option-value="{{ variant.title }}"
                            data-product-option>
                            {{ variant.title }}
                          </div>
                        {% endfor %}
                      </div>
                    {% endif %}

                  {% endif %}

                {% endif %}
                <input
                  type="hidden"
                  name="id"
                  value="{{ product.selected_or_first_available_variant.id }}">
              </div>

            {%- when 'quantity_selector' -%}
              <div class="ProductForm__QuantitySelector" {{ block.shopify_attributes }}>
                {%- if block.settings.show_label -%}
                  <span class="ProductForm__Label">{{ 'product.form.quantity' | t }}:</span>
                {%- endif -%}

                <div class="QuantitySelector QuantitySelector--large">
                  {%- assign quantity_minus_one = line_item.quantity | minus: 1 -%}

                  <button
                    type="button"
                    class="QuantitySelector__Button Link Link--secondary"
                    data-action="decrease-quantity">{% render 'icon' with 'minus' %}</button>
                  <input
                    type="text"
                    class="QuantitySelector__CurrentQuantity"
                    pattern="[0-9]*"
                    name="quantity"
                    value="1"
                    aria-label="{{ 'product.form.quantity' | t }}">
                  <button
                    type="button"
                    class="QuantitySelector__Button Link Link--secondary"
                    data-action="increase-quantity">{% render 'icon' with 'plus' %}</button>
                </div>
              </div>

            {%- when 'inventory' -%}
              {%- assign hide_inventory_quantity_by_default = false -%}

              {%- if product.selected_or_first_available_variant.inventory_management == blank or product.selected_or_first_available_variant.inventory_quantity <= 0 -%}
                {%- assign hide_inventory_quantity_by_default = true -%}
              {%- endif -%}

              {%- if block.settings.inventory_quantity_threshold != 0 and product.selected_or_first_available_variant.inventory_quantity > block.settings.inventory_quantity_threshold -%}
                {%- assign hide_inventory_quantity_by_default = true -%}
              {%- endif -%}

              <p
                class="ProductForm__Inventory Text--subdued"
                {% if hide_inventory_quantity_by_default %}
                style="display: none"
                {% endif %}
                {{ block.shopify_attributes }}>
                {%- if block.settings.inventory_quantity_threshold == 0 -%}
                  {{- 'product.form.inventory_quantity_count' | t: count: product.selected_or_first_available_variant.inventory_quantity -}}
                {%- else -%}
                  {{- 'product.form.low_inventory_quantity_count' | t: count: product.selected_or_first_available_variant.inventory_quantity -}}
                {%- endif -%}
              </p>

            {%- when 'buy_buttons' -%}
              {%- if block.settings.show_payment_button == false or product.selling_plan_groups.size > 0 -%}
                {%- assign use_primary_button = true -%}
              {%- else -%}
                {%- assign use_primary_button = false -%}
              {%- endif -%}

              <div class="ProductForm__BuyButtons" {{ block.shopify_attributes }}>
                {%- if block.settings.show_payment_button and product.selected_or_first_available_variant.available == false -%}
                  <style>
                    #shopify-section-{{ section.id }} .shopify-payment-button {
                      display: none;
                    }
                  </style>
                {%- endif -%}

                <button
                  type="submit"
                  data-use-primary-button="{% if use_primary_button %}true{% else %}false{% endif %}"
                  class="ProductForm__AddToCart Button {% if product.selected_or_first_available_variant.available and use_primary_button %}Button--primary{% else %}Button--secondary{% endif %} Button--full"
                  {% if product.selected_or_first_available_variant.available %}
                  data-action="add-to-cart"
                  {% else %}
                  disabled="disabled"
                  {% endif %}>
                  {%- if product.selected_or_first_available_variant.available -%}
                    <span>
                      {% if product.template_suffix == 'pre-order' %}
                        {{ 'product.form.pre_order' | t }}
                      {% else %}
                        {{ 'product.form.add_to_cart' | t }}
                      {% endif %}
                    </span>

                    {%- if block.settings.show_price_in_button -%}
                      <span class="Button__SeparatorDot"></span>
                      <span>{{ product.selected_or_first_available_variant.price | money }}</span>
                    {%- endif -%}
                  {%- else -%}
                    {{- 'product.form.sold_out' | t -}}
                  {%- endif -%}
                </button>

                {%- if block.settings.show_payment_button and product.template_suffix != 'pre-order' -%}
                  {{ form | payment_button }}
                {%- endif -%}
              </div>

            {% comment %} description {% endcomment %}
            {%- when 'description' -%}
              {%- if product.description != blank -%}
                <div class="ProductMeta__Description" {{ block.shopify_attributes }}>
                  <div class="Rte">
                    {{- product.description | replace: 'data-section-type', 'data-section-type-placeholder' -}}
                  </div>
                </div>
              {%- endif -%}
              <div class="desktop_product_tabs">
                {% render 'dynamic-tabs' %}
              </div>

            {%- when 'store_pickup' -%}
              {%- comment -%}The availability container will be added automatically if there is store pickup available{%- endcomment -%}
              <div class="ProductMeta__StoreAvailabilityContainer" {{ block.shopify_attributes }}></div>

            {%- when 'text' -%}
              {%- if block.settings.text != blank -%}
                <div class="ProductMeta__Text" {{ block.shopify_attributes }}>
                  {{- block.settings.text -}}
                </div>
              {%- endif -%}

            {%- when 'liquid' -%}
              {%- if block.settings.liquid != blank -%}
                <div class="ProductMeta__Text" {{ block.shopify_attributes }}>
                  {{ block.settings.liquid }}
                </div>
              {%- endif -%}

          {%- endcase -%}
        {%- endfor -%}

        {%- unless has_ouputted_variant_selector -%}
          {%- comment -%}If for any reason the merchant has removed the variant selector block, we still output the ID here{%- endcomment -%}

        {%- endunless -%}
      {%- endform -%}

      {%- if section.settings.stack_images and product_aside != blank and media_count > 0 -%}
        <div class="Product__QuickNav hidden-pocket">
          <div class="Product__QuickNavWrapper">
            <a href="#ProductAside" class="Heading Link Link--secondary u-h7">{{ 'product.form.view_info' | t }} {% render 'icon' with 'select-arrow-right' %}</a>
            <a href="#ProductGallery" class="Heading Link Link--secondary u-h7">{{ 'product.form.view_images' | t }} {% render 'icon' with 'select-arrow-right' %}</a>
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>